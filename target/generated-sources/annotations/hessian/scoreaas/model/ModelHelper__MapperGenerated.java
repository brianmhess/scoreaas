package hessian.scoreaas.model;

import com.datastax.oss.driver.api.core.data.GettableByName;
import com.datastax.oss.driver.api.core.data.SettableByName;
import com.datastax.oss.driver.api.mapper.MapperContext;
import com.datastax.oss.driver.api.mapper.MapperException;
import com.datastax.oss.driver.api.mapper.entity.saving.NullSavingStrategy;
import com.datastax.oss.driver.api.querybuilder.QueryBuilder;
import com.datastax.oss.driver.api.querybuilder.delete.Delete;
import com.datastax.oss.driver.api.querybuilder.delete.DeleteSelection;
import com.datastax.oss.driver.api.querybuilder.insert.InsertInto;
import com.datastax.oss.driver.api.querybuilder.insert.RegularInsert;
import com.datastax.oss.driver.api.querybuilder.relation.Relation;
import com.datastax.oss.driver.api.querybuilder.select.Select;
import com.datastax.oss.driver.api.querybuilder.select.SelectFrom;
import com.datastax.oss.driver.api.querybuilder.update.UpdateStart;
import com.datastax.oss.driver.internal.mapper.entity.EntityHelperBase;
import com.datastax.oss.driver.internal.querybuilder.update.DefaultUpdate;
import com.datastax.oss.driver.shaded.guava.common.collect.ImmutableList;
import java.lang.Class;
import java.lang.Integer;
import java.lang.Override;
import java.lang.String;
import java.util.List;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * Generated by the DataStax driver mapper, do not edit directly.
 */
public class ModelHelper__MapperGenerated extends EntityHelperBase<Model> {
  private static final Logger LOG = LoggerFactory.getLogger(ModelHelper__MapperGenerated.class);

  private final List<String> primaryKeys;

  public ModelHelper__MapperGenerated(MapperContext context) {
    super(context, "model");
    LOG.debug("[{}] Entity Model will be mapped to {}{}",
        context.getSession().getName(),
        getKeyspaceId() == null ? "" : getKeyspaceId() + ".",
        getTableId());
    this.primaryKeys = ImmutableList.<String>builder()
        .add("model_name")
        .add("model_version")
        .build();
  }

  @Override
  public Class<Model> getEntityClass() {
    return Model.class;
  }

  @Override
  public <SettableT extends SettableByName<SettableT>> SettableT set(Model entity, SettableT target,
      NullSavingStrategy nullSavingStrategy) {

    if (entity.getModel_name() != null || nullSavingStrategy == NullSavingStrategy.SET_TO_NULL) {
      target = target.set("model_name", entity.getModel_name(), String.class);
    }

    if (entity.getModel_version() != null || nullSavingStrategy == NullSavingStrategy.SET_TO_NULL) {
      target = target.set("model_version", entity.getModel_version(), Integer.class);
    }

    if (entity.getModel() != null || nullSavingStrategy == NullSavingStrategy.SET_TO_NULL) {
      target = target.set("model", entity.getModel(), String.class);
    }

    return target;
  }

  @Override
  public Model get(GettableByName source) {
    Model returnValue = new Model();

    returnValue.setModel_name(source.get("model_name", String.class));

    returnValue.setModel_version(source.get("model_version", Integer.class));

    returnValue.setModel(source.get("model", String.class));
    return returnValue;
  }

  @Override
  public RegularInsert insert() {
    throwIfKeyspaceMissing();
    InsertInto insertInto = (keyspaceId == null)
        ? QueryBuilder.insertInto(tableId)
        : QueryBuilder.insertInto(keyspaceId, tableId);
    return insertInto
        .value("model_name", QueryBuilder.bindMarker("model_name"))
        .value("model_version", QueryBuilder.bindMarker("model_version"))
        .value("model", QueryBuilder.bindMarker("model"));
  }

  public Select selectByPrimaryKeyParts(int parameterCount) {
    Select select = selectStart();
    for (int i = 0; i < parameterCount && i < primaryKeys.size(); i++) {
      String columnName = primaryKeys.get(i);
      select = select.whereColumn(columnName).isEqualTo(QueryBuilder.bindMarker(columnName));
    }
    return select;
  }

  @Override
  public Select selectByPrimaryKey() {
    return selectByPrimaryKeyParts(primaryKeys.size());
  }

  @Override
  public Select selectStart() {
    throwIfKeyspaceMissing();
    SelectFrom selectFrom = (keyspaceId == null)
        ? QueryBuilder.selectFrom(tableId)
        : QueryBuilder.selectFrom(keyspaceId, tableId);
    return selectFrom
        .column("model_name")
        .column("model_version")
        .column("model");
  }

  public DeleteSelection deleteStart() {
    throwIfKeyspaceMissing();
    return (keyspaceId == null)
        ? QueryBuilder.deleteFrom(tableId)
        : QueryBuilder.deleteFrom(keyspaceId, tableId);
  }

  public Delete deleteByPrimaryKeyParts(int parameterCount) {
    if (parameterCount <= 0) {
      throw new MapperException("parameterCount must be greater than 0");
    }
    DeleteSelection deleteSelection = deleteStart();
    String columnName = primaryKeys.get(0);
    Delete delete = deleteSelection.whereColumn(columnName).isEqualTo(QueryBuilder.bindMarker(columnName));
    for (int i = 1; i < parameterCount && i < primaryKeys.size(); i++) {
      columnName = primaryKeys.get(i);
      delete = delete.whereColumn(columnName).isEqualTo(QueryBuilder.bindMarker(columnName));
    }
    return delete;
  }

  @Override
  public Delete deleteByPrimaryKey() {
    return deleteByPrimaryKeyParts(primaryKeys.size());
  }

  @Override
  public DefaultUpdate updateStart() {
    throwIfKeyspaceMissing();
    UpdateStart update = (keyspaceId == null)
        ? QueryBuilder.update(tableId)
        : QueryBuilder.update(keyspaceId, tableId);
    return ((DefaultUpdate)update
        .setColumn("model", QueryBuilder.bindMarker("model")));
  }

  @Override
  public DefaultUpdate updateByPrimaryKey() {
    return ((DefaultUpdate)updateStart()
        .where(Relation.column("model_name").isEqualTo(QueryBuilder.bindMarker("model_name")))
        .where(Relation.column("model_version").isEqualTo(QueryBuilder.bindMarker("model_version"))));
  }
}
